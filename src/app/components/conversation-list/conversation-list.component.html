<div class="conversation-list">
  <div class="conversation-header">
    <h3>Conversations</h3>
    <p-button
      icon="pi pi-plus"
      label="New Chat"
      (onClick)="createNewConversation()"
      [loading]="conversationService.loading()"
      size="small"
    />
  </div>

  <div class="conversations">
    <!-- Debug info -->
    <!-- <div style="background: yellow; padding: 10px; margin: 10px;">
      <strong>DEBUG:</strong><br>
      Conversations count: {{ conversationService.conversations().length }}<br>
      Loading: {{ conversationService.loading() }}<br>
      Raw conversations: {{ conversationService.conversations() | json }}
    </div> -->

    @if (conversationService.loading() && conversationService.conversations().length === 0) {
      <div class="loading-state">
        <p>Loading conversations...</p>
      </div>
    }

    @if (conversationService.conversations().length === 0 && !conversationService.loading()) {
      <div class="empty-state">
        <p>No conversations yet. Create your first chat!</p>
      </div>
    }

    @for (conversation of conversationService.conversations(); track conversation.id) {
      <div
        class="conversation-item"
        [ngClass]="{ 'active': conversation.id === conversationService.activeConversationId() }"
      >
        <div class="conversation-content" (click)="selectConversation(conversation.id)">
          <div class="conversation-title">
            {{ conversation.title || 'New Conversation' }}
          </div>
          <div class="conversation-date">
            {{ conversation.updatedAt | date:'short' }}
          </div>
        </div>
        <div class="conversation-actions">
          <p-button
            icon="pi pi-trash"
            severity="danger"
            [text]="true"
            size="small"
            (onClick)="deleteConversation(conversation.id, $event)"
            [loading]="conversationService.loading()"
            class="delete-button"
          />
        </div>
      </div>
    }
  </div>
</div>